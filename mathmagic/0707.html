<!doctype html public "-//IETF//DTD HTML//EN"><HTML><HEAD><TITLE>Math Magic</TITLE></HEAD><BODY background="formulas.gif"><font size=+1>

<CENTER><H1>Problem of the Month (July 2007)</H1></CENTER>

The problem of finding <a href="http://www.ktn.freeuk.com/">closed knight tours</a> of rectangular chessboards is well-known.  An m&times;n chessboard has a closed knight tour for m&le;n when mn is even except when m=1, 2, or 4, or when m=3 and n&lt;10.  Now consider a whole army of knights located on every light square in such a tour, and give the tour some orientation.  No knight attacks any other, and this remains true as every knight moves simultaneously around the tour one move at a time.<p>

We generalize this by looking for closed tours of rectangular chessboards by Kings, Rooks, or Queens so that each piece moves only one square at a time, and no piece attacks any other as they move around the tour.  For a given rectangle, what is the largest number of Rooks that can be in a closed non-threatening tour?  What are the corresponding answers for Kings and Queens?  

<P><hr><p><center><h1>ANSWERS</h1></center>

Let R(m,n), K(m,n), and Q(m,n) be the maximum number of the corresponding chess pieces that can be part of a closed non-threatening tour.  It is clear that R(m,n) &le; min{m,n} and Q(m,n) &le; min{m,n}, since no more than one piece can be in any row at any given time.  It is less obvious that K(m,n) &le; <img src="lceil.gif" valign=center> m/2 <img src="rceil.gif" valign=center> <img src="lceil.gif" valign=center> n/2 <img src="rceil.gif" valign=center>, because this is the maximum number of non-attacking Kings that will fit on such a chessboard.  This can be reduced by 1 when m or n is odd, and reduced by 2 when both are odd, but surely there is a better upper bound?  Corey Plover and Claudio Baiocchi noticed that K(m,n) &ge; Q(m,n), since the pieces have the same moves and the Queens are more restricted.<p>

You can click on some of the tours below for an animation of the tour.<p>

I proved that R(3,4n+2)=3 and R(3,2n)&ge;2 by generalizing these tours:<p>

<table align=center><tr align=center>
<td><a href="0707/R3x6.gif"><img src="0707/R3x6still.gif" align=center></a><br>(animation)
<td width=50>
<td><a href="0707/R3x4.gif"><img src="0707/R3x4still.gif" align=center></a><br>(animation) </table><p>

David Bush proved that R(2n,2m)=2min{m,n} by considering zig-zag tours like this: <img src="0707/R8x8.gif" align=center><p>

<hr>

David Bevan gave some great results for K(n,m), verifying many results by computer.<p>

He showed these optimal values for K(3,n):<p>

<center><img src="0707/K3x5.gif">&nbsp; &nbsp;<img src="0707/K3x7.gif">&nbsp; &nbsp;<img src="0707/K3x9.gif"></center><p>

<center><img src="0707/K3x11.gif">&nbsp; &nbsp;<img src="0707/K3x13.gif"></center><p>

He showed these other lower bounds for K(3,n):<p>

<center><img src="0707/K3x15.gif">&nbsp; &nbsp;<img src="0707/K3x17.gif"></center><p>

And he showed K(3,2n)&ge;n by generalizing the tour:<p>
 
<center><img src="0707/K3x10.gif"></center><p>

He showed K(4,n)&ge;n-1 (and that K(4,n)=n-1 for 3&le;n&le;8) with a series of tours:<p>

<center><img src="0707/K4x4.gif">&nbsp; &nbsp;
<img src="0707/K4x5.gif">&nbsp; &nbsp;
<img src="0707/K4x6.gif"></center><p>

He showed K(4,rs)&ge;2s for r&ge;3 by generalizing the tour:<p> 

<center><img src="0707/K4x15a.gif"></center><p>

He showed K(4,rs)&ge;4s for r&ge;5 odd by generalizing the tour:<p>

<center><img src="0707/K4x15b.gif"></center><p>

He showed K(4,rs)&ge;8s for r&ge;13 odd by generalizing the tour:<p>

<center><img src="0707/K4x13.gif"></center><p>

He showed K(5,n)&ge;n for r&ge;3 by generalizing these tours:<p>

<center><img src="0707/K5x10.gif" align=center>&nbsp; &nbsp;<img src="0707/K5x11.gif" align=center></center><p>

He showed these lower bounds for larger rectangles:<p>

<center><img src="0707/K6x6.gif" align=center>&nbsp; &nbsp; <img src="0707/K6x7.gif" align=center>&nbsp; &nbsp; <img src="0707/K6x9.gif" align=center>&nbsp; &nbsp; <img src="0707/K6x10.gif" align=center> </center><p>

<center><img src="0707/K7x7.gif" align=center>&nbsp; &nbsp; <img src="0707/K7x8.gif" align=center>&nbsp; &nbsp;<img src="0707/K8x8.gif" align=center></center><p>

Finally, he gave a very general tour that shows K(3n,4m)&ge;2mn:

<center><img src="0707/K3nx4m.gif"></center><p>

Claudio Baiocchi sent me an applet to animate most of these tours.<p>

Here are the best known bounds on K(n,m):<p>

<center><font size=+2>Bounds for K(n,m)</font></center>
<TABLE BORDER=1 cellpadding=5 align=center bgcolor=FFFFDD>
<TR bgcolor=99FF99><th>n \ m         <th>3<th>4<th> 5   <th> 6   <th> 7    <th> 8    <th> 9     <th> 10   <th> 11    <th> 12    <th> 13    <th> 14 <th> 15   <th> 16   <th> 17 
<TR align=center><th bgcolor=99FF99>3<td>1<td>2<td> 3   <td> 3   <td> 2    <td> 4    <td> 3     <td> 5    <td> 5     <td> 6     <td> 4     <td> 7  <td>[5,14]<td>[8,15]<td>[7,16]
<TR align=center><th bgcolor=99FF99>4<td> <td>3<td> 4   <td> 5   <td> 6    <td> 7    <td> [8,9] <td>[9,10]<td>[10,11]<td>[11,12]<td>[12,13]<td>[13,14]<td><td><td>
<TR align=center><th bgcolor=99FF99>5<td> <td> <td>[5,7]<td>[6,8]<td>[7,10]<td>[8,11]<td>[9,13]<td>[10,14]<td>[11,16]<td>[12,17]<td>[13,19]<td>[14,20]<td><td><td>
<TR align=center><th bgcolor=99FF99>6<td> <td> <td>     <td>[6,9]<td>[7,11]<td>[8,12]<td>[9,14]<td>[12,15]<td><td><td><td><td><td><td>
<TR align=center><th bgcolor=99FF99>7<td> <td> <td>     <td>     <td>[7,14]<td>[8,15]<td><td><td><td><td><td><td><td><td>
<TR align=center><th bgcolor=99FF99>8<td> <td> <td>     <td>     <td>      <td>[8,16]<td><td><td><td><td><td><td><td><td>
</tr></table><p>

<hr>

I showed Q(3,5)=1, and showed Q(3,4)=2 and Q(3,6)=3 with the tours below:<p>

<table align=center><tr align=center>
<td><a href="0707/Q3x4.gif"><img src="0707/Q3x4still.gif" align=center></a><br>(animation)
<td width=50>
<td><a href="0707/Q3x6.gif"><img src="0707/Q3x6still.gif" align=center></a><br>(animation)
</table><p>

David Bevan gave many great results for Q(n,m).  He showed Q(3,7)=1 with his computer program.<p>

He showed Q(3,9)=2, Q(3,11)=2, and Q(3,13)&ge;2:<p>

<center><img src="0707/Q3x9.gif" align=center>&nbsp; &nbsp;<img src="0707/Q3x11.gif" align=center>&nbsp; &nbsp;<img src="0707/Q3x13.gif" align=center></center><p>

He showed Q(3,2n)&ge;2 for n&ge;4 by generalizing these tours:<p>

<center><img src="0707/Q3x8.gif" align=center>&nbsp; &nbsp;<img src="0707/Q3x10.gif" align=center></center><p>

He showed Q(3,3n)&ge;3 for n&ge;4 by generalizing these tours:<p>

<center><img src="0707/Q3x12.gif" align=center>&nbsp; &nbsp;<img src="0707/Q3x15.gif" align=center></center><p>

He showed these optimal values of Q(4,n):<p>

<center><img src="0707/Q4x4.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x5.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x6.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x7.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x8.gif" align=center></center><p>

He showed these lower bounds for Q(4,n):<p>

<center><img src="0707/Q4x9.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x11.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x15.gif" align=center></center><p>

He showed that Q(4,2n)=4 for n&ge;5 by generalizing these tours:<p>

<center><img src="0707/Q4x10.gif" align=center>&nbsp; &nbsp;<img src="0707/Q4x12.gif" align=center></center><p>

He showed these optimal values of Q(5,n):<p>

<center><img src="0707/Q5x5.gif" align=center>&nbsp; &nbsp;<img src="0707/Q5x6.gif" align=center></center><p>

He showed these lower bounds for Q(5,n):<p>

<center><img src="0707/Q5x7.gif" align=center>&nbsp; &nbsp;<img src="0707/Q5x8.gif" align=center>&nbsp; &nbsp;<img src="0707/Q5x10.gif" align=center></center><p>

<center><img src="0707/Q5x12.gif" align=center>&nbsp; &nbsp;<img src="0707/Q5x14.gif" align=center></center><p>

<center><img src="0707/Q5x16.gif" align=center>&nbsp; &nbsp;<img src="0707/Q5x18.gif" align=center></center><p>

He showed these lower bounds for Q(6,n):<p>

<center><img src="0707/Q6x6.gif" align=center>&nbsp; &nbsp;<img src="0707/Q6x7.gif" align=center>&nbsp; &nbsp;<img src="0707/Q6x8.gif" align=center></center><p>

<center><img src="0707/Q6x9.gif" align=center>&nbsp; &nbsp;<img src="0707/Q6x10.gif" align=center>&nbsp; &nbsp;<img src="0707/Q6x12.gif" align=center></center><p>

Here are the best known bounds on Q(n,m):<p>

<center><font size=+2>Bounds for Q(n,m)</font></center>
<TABLE BORDER=1 cellpadding=5 align=center bgcolor=FFFFDD>
<TR bgcolor=99FF99><th>n \ m         <th>3<th>4<th>5<th>6<th> 7   <th> 8   <th> 9   <th>10<th> 11  <th>12<th> 13 <th> 14 <th> 15 <th> 16 <th> 17 <th> 18 
<TR align=center><th bgcolor=99FF99>3<td>1<td>2<td>1<td>3<td> 1   <td> 2   <td> 2   <td>2<td> 2   <td>3<td>[2,3]<td>[2,3]<td>3<td>[2,3]<td>[1,3]<td>3
<TR align=center><th bgcolor=99FF99>4<td> <td>2<td>2<td>3<td> 2   <td> 3   <td>[3,4]<td>4<td>[2,4]<td>4<td>[1,4]<td> 4 <td>[2,4]<td> 4 <td>[1,4]<td> 4 
<TR align=center><th bgcolor=99FF99>5<td> <td> <td>2<td>3<td>[2,5]<td>[4,5]<td>[1,5]<td>5<td>[1,5]<td>5<td>[1,5]<td>5<td>[1,5]<td>5<td>[1,5]<td>5
<TR align=center><th bgcolor=99FF99>6<td> <td> <td> <td>[3,5]<td>[2,6]<td>[4,6]<td>[2,6]<td>[5,6]<td>[1,6]<td>6<td><td><td><td><td><td>
</tr></table><p>

<HR><p>If you can extend any of these results, please <a href="mailto:erichfriedman68@gmail.com">e-mail</a> me.  Click <a href="https://erich-friedman.github.io/mathmagic/">here</a> to go back to Math Magic.  <font size=-1>Last updated 7/25/07.<font>
</BODY></HTML>