<!doctype html public "-//IETF//DTD HTML//EN"><HTML><HEAD><TITLE>Math Magic</TITLE></HEAD><BODY background="formulas.gif"><font size=+1><CENTER><H1> Problem of the Month (February 2002)</H1></CENTER>This month we explore <b>sum matrices</b>, n&times;n matrices with the property that every entry is the sum of the adjacent horizontal and vertical entries mod b.  For example, the only 4&times;4 matrices (up to reflection and rotation) which are sum matrices mod 2 are:<p><center><img src="0202/4,2.gif"></center><p>For other values of n and b, how many sum matrices are there?  What do they look like?  For other values of n and b, how many sum matrices are there?  What do they look like?  We say a sum matrix is <b>primitive</b> if it does not have any rows or columns of all 0's, and the GCD of all the entries is 1.  How many primitive sum matrices are there?<p>

<P><hr><p><center><h1>ANSWERS</h1></center>Berend Jan van der Zwaag found the primitive 2&times;2 and 5&times;5 sum matrices in base 2.<p>Jeremy Galvagni found some small sum matrices, including the n=4 and n=5 ones in any base.<p>Joseph DeVincentis proved using algebra that there are 2&times;2 sum matrices only in bases divisible by 3 with only 1 primitive 2&times;2 sum matrix, and that there are 3&times;3 sum matrices only in bases divisible by 7 with only 6 primitive 3&times;3 matrices.  Claudio Baiocchi used a computer to prove the above.<p>Ludek Frey, Boris Bukh, and Olexandr Ravsky showed that the maximum number of solutions for a fixed n and b is no more than b<sup>n</sup>.<p>Berend Jan van der Zwaag was able to count the number of sum matrices for various n and b:<p><center><font size=+2>Number of n&times;n Sum Matrices in Base b</font></center><center><table border=1 bgcolor="FFFFCC" cellpadding=2><tr align=center><th>n \ b<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>11<th>12<th>13<th>14<th>15</tr><tr align=center><th>2<td>1<td><a href="0202/2,3.gif">2</a><td>1<td>1<td><a href="0202/2,6.gif">2</a><td>1<td>1<td><a href="0202/2,9.gif">2</a><td>1<td>1<td><a href="0202/2,12.gif">2</a><td>1<td>1<td>2</tr><tr align=center><th>3<td>1<td>1<td>1<td>1<td>1<td><a href="0202/3,7.gif">7</a><td>1<td>1<td>1<td>1<td>1<td>1<td><a href="0202/3,14.gif">7</a><td>1</tr><tr align=center><th>4<td><a href="0202/4,2.gif">5</a><td><a href="0202/4,3.gif">6</a><td><a href="0202/4,4.gif">17</a><td><a href="0202/4,5.gif">15</a><td><a href="0202/4,6.gif">36</a><td><a href="0202/4,7.gif">28</a><td>62<td>45<td>95<td>66<td>135<td>91<td>182<td>120</tr><tr align=center><th>5<td><a href="0202/5,2.gif">3</a><td><a href="0202/5,3.gif">7</a><td><a href="0202/5,4.gif">6</a><td><a href="0202/5,5.gif">6</a><td><a href="0202/5,6.gif">23</a><td><a href="0202/5,7.gif">10</a><td><a href="0202/5,8.gif">15</a><td>40<td>21<td>231<td>71<td>28<td>36<td>100</tr><tr align=center><th>6<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>322<td>1<td>1</tr><tr align=center><th>7<td>1<td>1<td>1<td>1<td>1<td>4<td>1<td>1<td>1<td>1<td>1<td>1<td>1<td>1</tr><tr align=center><th>8<td>1<td><a href="0202/8,3.gif">25</a><td>1<td>1<td>25<td>1<td>1<td>70<td>1<td>1</tr><tr align=center><th>9<td>43<td><a href="0202/9,3.gif">4</a><td>628<td>9<td>325</tr><tr align=center><th>10<td>1<td>1<td>1<td>1<td>1</tr><tr align=center><th>11<td><a href="0202/11,2.gif">21</a></tr><tr align=center><th>12<td>1</tr><tr align=center><th>13<td>1</tr><tr align=center><th>14<td><a href="0202/14,2.gif">5</a></tr><tr align=center><th>15<td>1</tr><tr align=center><th>16<td>43</tr></table></center><p><center><font size=+2>Number of Primitive n&times;n Sum Matrices in Base b</font></center><center><table border=1 bgcolor="FFFFCC" cellpadding=2><tr align=center><th>n \ b<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>11<th>12<th>13<th>14<th>15</tr><tr align=center><th>2<td>0<td><a href="0202/2,3p.gif">1</a><td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0</tr><tr align=center><th>3<td>0<td>0<td>0<td>0<td>0<td><a href="0202/3,7p.gif">6</a><td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0</tr><tr align=center><th>4<td><a href="0202/4,2p.gif">4</a><td><a href="0202/4,3p.gif">5</a><td><a href="0202/4,4p.gif">12</a><td><a href="0202/4,5p.gif">14</a><td><a href="0202/4,6p.gif">26</a><td><a href="0202/4,7p.gif">27</a><td>45<td>39<td>76<td>65<td>87<td>90<td>150<td>99</tr><tr align=center><th>5<td><a href="0202/5,2p.gif">1</a><td><a href="0202/5,3p.gif">3</a><td><a href="0202/5,4p.gif">2</a><td><a href="0202/5,5p.gif">3</a><td><a href="0202/5,6p.gif">11</a><td><a href="0202/5,7p.gif">6</a><td><a href="0202/5,8p.gif">7</a><td>27<td>11<td>225<td>40<td>21<td>21<td>78</tr><tr align=center><th>6<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>321<td>0<td>0</tr><tr align=center><th>7<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0</tr><tr align=center><th>8<td>0<td><a href="0202/8,3p.gif">23</a><td>0<td>0<td>0<td>0<td>0<td>42<td>0<td>0</tr><tr align=center><th>9<td>33<td>0<td>523<td>0<td>246</tr><tr align=center><th>10<td>0<td>0<td>0<td>0<td>0</tr><tr align=center><th>11<td><a href="0202/11,2p.gif">10</a></tr><tr align=center><th>12<td>0</tr><tr align=center><th>13<td>0</tr><tr align=center><th>14<td>0</tr><tr align=center><th>15<td>0</tr></table></center><p>Claudio Baiocchi, Helmut Postl, and Olexandr Ravsky noticed that the set of solutions for a fixed n and b form a vector space.  Any potential solution is completely determined by its left column, and those which give solutions are those in which the (n+1)<sup>st</sup> column vanishes.  For each trivial unit vector which form a basis for the first column, find the corresponding (n+1)<sup>st</sup> column, and try to find some linear combination of these that vanishes.<p>If we form a matrix A(n) from these vectors, we can find non-trivial solutions when the determinant of A(n) equals zero.  This happens when n = 4, 5, 9, 11, 14, 17, 19, 23, 24, 29, 34, 35, 39, 41, 44, 47, 49, 53, 54, 59, 64, 65, 69, 71, 74, 77, 79, 83, 84, 89, 94, 95, 99, . . . .  Somewhat surprisingly, the nullspace of these matrices all have dimension 2.<p>When the determinant is non-zero, it tells us something about which b will have solutions.  The determinants are shown in the table below.  Those for n &le; 11 were furnished by Claudio Baiocchi, and I extended the table.<p><center><font size=+2>Determinant of Matrix A(n)</font></center><center><table border=1 bgcolor="FFFFCC" cellpadding=2><tr align=center><th bgcolor=lightgreen>n<td>2<td>3<td>4<td>5<td>6<td>7<td>8<td>9<td>10<td>11<td>12<td>13<td>14<td>15<td>16<tr align=center><th bgcolor=lightgreen>Det A(n)<td>&ndash;3<td>&ndash;7<td>0<td>0<td>13<sup>3</sup><td>&ndash;7 17<sup>3</sup><td>&ndash;3<sup>6</sup> 17<sup>2</sup> 19<td>0<td>23<sup>5</sup> 43<td>0<td>&ndash;3<sup>6</sup> 5<sup>6</sup> 53<sup>3</sup> 79<td>&ndash;3<sup>6</sup> 13<sup>3</sup> 29<sup>6</sup> 251<td>0<td>7 17<sup>3</sup> 31<sup>8</sup> 127<sup>2</sup> 223<td>&ndash;2<sup>16</sup> 67<sup>5</sup> 101<sup>2</sup> 103<sup>2</sup> 409</tr></table></center><p><center><table border=1 bgcolor="FFFFCC" cellpadding=2><tr align=center><th bgcolor=lightgreen>n<td>17<td>18<td>19<td>20<td>21<td>12<td>23<td>24<tr align=center><th bgcolor=lightgreen>Det A(n)<td>0<td>&ndash;37<sup>11 </sup>113<sup>4</sup> 191<sup>2</sup> 647<td>0<td>3 7<sup>8</sup> 13<sup>3</sup> 41<sup>7</sup> 43<sup>8</sup> 83<sup>2</sup> 379<td>23<sup>5</sup> 43<sup>9</sup> 89<sup>6</sup> 131<sup>2</sup> 263<sup>2</sup> 1451<td>&ndash;47<sup>10</sup> 137<sup>4</sup> 139<sup>4</sup> 277<sup>2</sup> 919<sup>2</sup> 1747<td>0<td>0</tr></table></center><p>Helmut Postl defined a sum matrix to be <b>basic</b> if it is a sum matrix in any base.  He investigated up to n=100 and found n=4 and n=5 have basic matrices, and that all larger basic matrices seem to be extensions of these.  This is confirmed by the fact that the values of n for which the determinant of A(n)=0 are those of the form n=5k&ndash;1 or n=6k&ndash;1.<p><center><pre>1  0  0  1     1  1  0 -1 -11 -1 -1  1     0  0  0  0  01 -1 -1  1    -1 -1  0  1  11  0  0  1     0  0  0  0  0               1  1  0 -1 -1</pre></center><p>Helmut Postl also sent me the <a href="0202/a1.txt">first rows</a> of all linearly independent n&times;n sum matrices in base b for n &le; 20 and b &le; 100, and <a href="0202/a2.txt">which sum matrices exist</a> for n &le; 100 and b &le; 100.<p>Let <b>s(n,b)</b> be the number of n x n sum matrices in base b.  Then Olexandr Ravsky and Boris Bukh showed that s(n,b) is a multiplicative function of b: if a and b are relatively prime, then s(n, ab) = s(n, a) s(n, b).  The proof is a consequence of the unique factorization of elements in Z<sub>ab</sub> into a product of elements from Z<sub>a</sub> and Z<sub>b</sub>.<p>Olexandr Ravsky went on to find a formula for s(n,b) in terms of the Smith Form of a matrix.  Consider the transformations of a matrix of adding to a row (or column) some multiple of another row (or column) or switching two rows (or columns).  Using these transformations, we can reduce any matrix to a diagonal matrix where each diagonal element divides the next.  This is the Smith Form of the matrix.  If we denote the diagonal elements of the Smith Form of A(n) as (d<sub>1</sub>, d<sub>2</sub>, ... d<sub>n</sub>), then s(n,b) is the product of the GCD(d<sub>i</sub>,b).<p>Boris Bukh showed that if b is prime, then s(n,b) is a power of b and (b-1) b<sup>k&ndash;1</sup> divides s(n,b<sup>k</sup>) &ndash; s(n,b<sup>k&ndash;1</sup>)His proof: Consider all sum matrices modulo b<sup>k</sup> such that not all elementsare divisible by b. There are s(n,b<sup>k</sup>) &ndash; s(n,b<sup>k&ndash;1</sup>) such sum matrices.Denote their set as M. Now we consider a family of maps over M, f<sub>t</sub> : a &rarr; at where GCD(t,b)=1. Obviously f<sub>t</sub> is a bijection. Call two sum matrices in M equivalentif there is a mapping f<sub>t</sub> that maps one onto another. It is easy to check this is an equivalence relation on M. In each equivalence class there are &phi;(b<sup>k</sup>) = (b&ndash;1) b<sup>k&ndash;1</sup> elements. Therefore, the cardinality of M is divisible by (b&ndash;1) b<sup>k&ndash;1</sup>.  As a corollary, he shows that in this case, (b&ndash;1) divides s(n,b<sup>k</sup>)&ndash;1.<p>Sasha Ravsky proved some things about the binary case.  His results can be found <a href="0202/ravsky.ps">here</a>.<p><p><HR>If you can extend any of these results, please <a href="mailto:efriedma@stetson.edu">e-mail</a> me.  Click <a href="http://www.stetson.edu/~efriedma/mathmagic/">here</a> to go back to Math Magic.  <font size=-1>Last updated 1/5/03.<font></BODY></HTML>