{\rtf1\ansi\ansicpg1252\uc1 \deff0\deflang1033\deflangfe1031{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f2\fmodern\fcharset0\fprq1{\*\panose 02070309020205020404}Courier New;}{\f3\froman\fcharset2\fprq2{\*\panose 05050102010706020507}Symbol;}{\f16\froman\fcharset238\fprq2 Times New Roman CE;}{\f17\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f19\froman\fcharset161\fprq2 Times New Roman Greek;}{\f20\froman\fcharset162\fprq2 Times New Roman Tur;}{\f21\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f28\fmodern\fcharset238\fprq1 Courier New CE;}{\f29\fmodern\fcharset204\fprq1 Courier New Cyr;}{\f31\fmodern\fcharset161\fprq1 Courier New Greek;}{\f32\fmodern\fcharset162\fprq1 Courier New Tur;}{\f33\fmodern\fcharset186\fprq1 Courier New Baltic;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\nowidctlpar\widctlpar\adjustright \fs20\lang1031\cgrid \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\s15\nowidctlpar\widctlpar\adjustright \f2\fs20\lang1031\cgrid \sbasedon0 \snext15 Plain Text;}}{\info{\title crmata}{\author POSTL}{\operator POSTL}{\creatim\yr2002\mo2\dy6\hr14\min58}{\revtim\yr2002\mo2\dy8\hr9\min59}{\version39}{\edmins0}{\nofpages5}{\nofwords1278}{\nofchars7290}{\*\company HPOS}{\nofcharsws0}{\vern73}}\paperw11906\paperh16838\margl1417\margr1417\margt1417\margb1134 \deftab708\widowctrl\ftnbj\aenddoc\hyphhotz425\hyphcaps0\formshade\viewkind1\viewscale100\pgbrdrhead\pgbrdrfoot \fet0\sectd \linex0\headery709\footery709\colsx709\endnhere\sectdefaultcl {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \s15\qj\sa120\nowidctlpar\widctlpar\tx4962\adjustright \f2\fs20\lang1031\cgrid {\b\f0\fs26\ul Sum matrices\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 Let n and b be given integers }{\f0\fs26 {\field{\*\fldinst SYMBOL 179 \\f "Symbol" \\s 13}{\fldrslt\f3\fs26}}}{\f0\fs26 2. Find all n}{\f0\fs26 {\field{\*\fldinst SYMBOL 180 \\f "Symbol" \\s 13}{\fldrslt\f3\fs26}}}{\f0\fs26 n-matrices where the following condition holds:\par }\pard \s15\qj\li426\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 Each cell of the matrix is the sum of all its horizontal and vertical neighbor cells modulo b.\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 A matrix which fulfills this condition is called a sum matrix.\par }{\b\f0\fs26 Remark:}{\f0\fs26  This definition applies for rectangular matrices as well. The following calculations remain the same in this case. For simplicity, we shall consider only square matrices here.\par }{\b\f0\fs26 Example:}{\f0\fs26  b=2, n=4. There are five sum matrices all in all, rotations and reflections not counted:\par }\pard \s15\nowidctlpar\widctlpar\adjustright {\fs26  0 0 0 0   1 0 0 0   1 0 0 1   1 0 1 0   0 1 1 0\par  0 0 0 0   1 1 0 0   1 1 1 1   1 0 1 1   1 0 0 1\par  0 0 0 0   1 0 1 0   1 1 1 1   0 0 1 0   1 0 0 1\par }\pard \s15\sa120\nowidctlpar\widctlpar\adjustright {\fs26  0 0 0 0   0 1 1 1   1 0 0 1   1 1 0 0   0 1 1 0\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 The all-zero matrix is trivial. It is solution for all b and n. If rotations and reflections are counted, there are exactly 16 matrices. We shall see how to count them efficiently.\par }{\b\f0\fs26 Question: }{\f0\fs26 For which b and n do sum matrices exist?\par }\pard \s15\qj\fi-284\li284\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 1.\tab A sum matrix is completely determined by its first row.\par \tab This is the most important observation for the following considerations!\par \tab Fill the first matrix row with arbitrary elements. There is no sum yet, so the matrix is consistent at this stage. Call S the center cell of a sum and A, B, C, D its neighbors. When A, B, C and S are known, we can compute D=S\endash A\endash B\endash C modulo b, where D denotes the bottom neighbor. In this way we can compute the rows inductively and so complete the matrix. The only sums still to be checked are the ones where the center cells lie in the last row.\par 2.\tab A simple algorithm to compute sum matrices.\par \tab Generate a matrix as described above. To see if it is a sum matrix, we have to check if the sums of the last row fulfill the condition. Or equivalently: Add another row }{\f0\fs26\ul below}{\f0\fs26  the matrix and compute its elements as above. Call this row the below-row. Then the matrix is a sum matrix if and only if all elements of the below-row are zero.\par \tab This implies the following algorithm to find all sum matrices:\par \tab For each possible setting for the first row (there are b}{\f0\fs26\super n}{\f0\fs26  possibilities) compute the matrix and the below-row. Check if the below-row is all zero.\par 3.\tab If two matrices A and B (not necessarily distinct) are sum matrices, then A+B modulo b is also a sum matrix.\par 4. An advanced algorithm to compute sum matrices.\par \tab Statement 3 implies that the sum matrices form a vector space, and therefore it is sufficient to test only the matrices of an appropriate base. The most natural one is the set of those n matrices where the first row (recall from statement 1 that the first row determines the entire matrix) is the i-th unit vector, i.e. the i-th element is 1, and all others are 0. Compute the below-rows for each matrix of the base. They form a new matrix M. To find all sum matrices, we have to solve the equation system x*M=o, where o is the zero vector. Then each solution x is the first row of a sum matrix. (The vectors x form the kernel of M. If matrix M has full rank, then x=o is the only solution, and in this case there exist no non-trivial sum matrices.)\par This algorithm works pretty fast!\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 Illustration for n=5, b=10:\par }\pard \s15\qj\nowidctlpar\widctlpar\adjustright {\fs26  1 0 0 0 0   0 1 0 0 0   0 0 1 0 0   0 0 0 1 0   0 0 0 0 1\par  1 9 0 0 0   9 1 9 0 0   0 9 1 9 0   0 0 9 1 9   0 0 0 9 1\par  1 8 1 0 0   8 2 8 1 0   1 8 2 8 1   0 1 8 2 8   0 0 1 8 1\par  2 7 3 9 0   7 5 6 3 9   3 6 5 6 3   9 3 6 5 7   0 9 3 7 2\par  4 4 6 6 1   4 0 0 7 6   6 0 1 0 6   6 7 0 0 4   1 6 6 4 4\par  ---------   ---------   ---------   ---------   ---------\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\fs26  8 7 3 0 5   7 1 7 8 0   3 7 6 7 3   0 8 7 1 7   5 0 3 7 8\par }{\f0\fs26 (Remark: The computation needs only to be done for the first half of the matrices since the others are symmetrical to the first ones.)\par Compute the kernel of matrix M. (Perform only row manipulations. The rows have roman numerals in the comments.) The left matrix is M, the right one yields a base of the vectors x.\par }\pard \s15\qj\nowidctlpar\widctlpar\adjustright {\fs26  8 7 3 0 5   1 0 0 0 0\par  7 1 7 8 0   0 1 0 0 0\par  3 7 6 7 3   0 0 1 0 0\par  0 8 7 1 7   0 0 0 1 0\par  5 0 3 7 8   0 0 0 0 1\par  ---------   ---------\par  1 3 1 4 0   0 3 0 0 0   3*II=I'\par  0 3 5 8 5   1 6 0 0 0   I-8*I'\par  0 8 3 5 3   0 1 1 0 0   III-3*I'\par  0 8 7 1 7   0 0 0 1 0   IV\par  0 5 8 7 8   0 5 0 0 1   V-5*I'\par  ---------   ---------\par  1 3 1 4 0   0 3 0 0 0   \par  0 1 5 6 5   7 2 0 0 0   7*II=II'\par  0 0 3 7 3   4 5 1 0 0   III-8*II'\par  0 0 7 3 7   4 4 0 1 0   IV-8*II'\par  0 0 3 7 3   5 5 0 0 1   V-5*II'\par  ---------   ---------\par  1 3 1 4 0   0 3 0 0 0   \par  0 1 5 6 5   7 2 0 0 0   \par  0 0 1 9 1   8 5 7 0 0   7*III=III'\par  0 0 0 0 0   8 9 1 1 0   IV-7*III'\par  0 0 0 0 0   1 0 9 0 1   V-3*III'\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\fs26  ---------   ---------\par }{\f0\fs26 The kernel base is \{(8,9,1,1,0), (1,0,9,0,1)\}, and the solution vectors x are of the form u*(8,9,1,1,0)+v*(1,0,9,0,1) = (8u+v,9u,u+9v,u,v), where u and v lie in the range 0\endash 9.\par So there exist exactly 100 sum matrices for n=5, b=10. One of them is always the all-zero matrix. Now one can eliminate rotations and reflections, if desired. I know no way to do this which is substantially faster (more than a constant factor in the magnitude of n) than checking each matrix.\par Example: a=4, b=3. The first row is (5,6,1,4,3), and the complete matrix is:\par }\pard \s15\qj\nowidctlpar\widctlpar\adjustright {\fs26    5 6 1 4 3\par    9 0 1 0 9\par    4 4 0 6 6\par    1 0 9 0 1\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\fs26    7 6 9 4 5\par }{\f0\fs26 Another example for bigger values: n=11, b=1000:\par }\pard \s15\qj\nowidctlpar\widctlpar\adjustright {\fs26  289 711 747 514 817 700 658 986 378 989 436\par  578 675 522 950 603 225 972 950 403 175 447\par  614 864 150 311 611 950 139 589 900 336 836\par  172 425 453 600 747 975 628 600 572 425  53\par  133 936 278  89 561 650 914 811 647 464 792\par   25 100 800 650  75 200 825 650 800 600 275\par  792 339 772 686 664 650  61 214 903  61 883\par  428 675 947 600 253 725 372 600 828 675 547\par  961 961 900 714 264 450 986 186 650 239 989\par  572 425 278 950 847 475 978 950 397 925 203\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\fs26  186 614   3 111 158 200 567 389 872  86 289\par }\pard \s15\qj\sb120\sa120\nowidctlpar\widctlpar\adjustright {\b\f0\fs26 Number of sum matrices for given b and n:\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 First compute the base set of vectors x, viz. \{x}{\f0\fs26\sub 1}{\f0\fs26 , x}{\f0\fs26\sub 2}{\f0\fs26 , ..., x}{\f0\fs26\sub k}{\f0\fs26 \}. Then every linear combination x\~=\~a}{\f0\fs26\sub 1}{\f0\fs26 x}{\f0\fs26\sub 1\~}{\f0\fs26 +\~a}{\f0\fs26\sub 2}{\f0\fs26 x}{\f0\fs26\sub 2}{\f0\fs26 \~+\~...\~+\~a}{\f0\fs26\sub k}{\f0\fs26 x}{\f0\fs26\sub k}{\f0\fs26  is the first row of a sum matrix.\par The }{\b\f0\fs26 total number of sum matrices}{\f0\fs26  N(n,b) is the product of all N}{\f0\fs26\sub i}{\f0\fs26  (i=1..k), where N}{\f0\fs26\sub i}{\f0\fs26  is the number of distinct vectors a}{\f0\fs26\sub i}{\f0\fs26 x}{\f0\fs26\sub i}{\f0\fs26  when a}{\f0\fs26\sub i}{\f0\fs26  varies. It is easy to see that N}{\f0\fs26\sub i}{\f0\fs26 \~=\~b\~/\~g.c.d.(b,\~x}{\f0\fs26\sub i1}{\f0\fs26 ,\~x}{\f0\fs26\sub i2}{\f0\fs26 ,\~...,\~x}{\f0\fs26\sub in}{\f0\fs26 ), where the x}{\f0\fs26\sub ij}{\f0\fs26  are the coordinates of the vector x}{\f0\fs26\sub i}{\f0\fs26 .\par When rotations and reflections are not counted, then a lower bound for this number N\lquote (n,b) is N(n,b)/8. This follows immediately from the fact that there are at most 8 rotations and reflections of a matrix (including the matrix itself).\par For example, N(11,10) = 10*10*10*10*2*2 = 40000, and N\lquote (11,10) }{\f0\fs26 {\field{\*\fldinst SYMBOL 179 \\f "Symbol" \\s 13}{\fldrslt\f3\fs26}}}{\f0\fs26  5000.\par }\pard \s15\qj\sb120\sa120\nowidctlpar\widctlpar\adjustright {\b\f0\fs26 Appendix files\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 The file append1.txt contains all bases of first rows for b=2..100 and n=2..20. The first line of an entry shows n and b. All immediately following lines beginning with \ldblquote First row\rdblquote  (may also be none) belong to these values n and b and form a vector base.\par The file append2.txt is a summary table for b=2..100 and n=2..100. An \'82X\lquote  means that there exist sum matrices, a \'82D\lquote  means that there exist only sum matrices where the g.c.d. of b and all elements is greater 1, and a dot means that there are no sum matrices.\par }\pard \s15\qj\sb120\sa120\nowidctlpar\widctlpar\adjustright {\b\f0\fs26 Extension of sum matrices\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 Let A be a sum matrix for given n and b. Then we can construct sum matrices for 2n+1, 3n+2, or generally qn+q\endash 1. Fill the bigger matrix with copies of A, B, C and D like a checkerboard in the following way:\par }\pard \s15\qj\sa60\nowidctlpar\widctlpar\tx709\tx1276\tx1843\tx2410\tx2977\adjustright {\f0\fs26 \tab A\tab B\tab A\tab B\tab ....\par \tab C\tab D\tab C\tab D\tab ....\par \tab A\tab B\tab A\tab B\tab ....\par \tab C\tab D\tab C\tab D\tab ....\par \tab ....\tab ....\tab ....\tab ....\tab ....\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 Denote A = (a}{\f0\fs26\sub i,j}{\f0\fs26 ). Then B = (\endash a}{\f0\fs26\sub i,n+1\endash j}{\f0\fs26 ), C = (\endash a}{\f0\fs26\sub n+1\endash i,j}{\f0\fs26 ) and D = (a}{\f0\fs26\sub n+1\endash i,n+1\endash j}{\f0\fs26 ) modulo b. B is the horizontal reflection of \endash A, C is the vertical reflection of \endash A (or the 180 degree rotation of B), and D is the 180 degree rotation of A.\par Finally, each two adjacent A/B/C/D-matrices are separated by a line or column of zeroes. Call this new matrix the extension of A. Extension matrices are not primitive, since they contain all-zero rows and columns.\par Example: Take the following matrix for n=4, b=10 and build the extension for n=14:\par }\pard \s15\qj\nowidctlpar\widctlpar\adjustright {\fs26  9 8 3 4   9 8 3 4 0 6 7 2 1 0 9 8 3 4\par  1 6 1 1   1 6 1 1 0 9 9 4 9 0 1 6 1 1\par  6 6 1 6   6 6 1 6 0 4 9 4 4 0 6 6 1 6\par  9 3 8 4   9 3 8 4 0 6 2 7 1 0 9 3 8 4\par            0 0 0 0 0 0 0 0 0 0 0 0 0 0\par            1 7 2 6 0 4 8 3 9 0 1 7 2 6\par            4 4 9 4 0 6 1 6 6 0 4 4 9 4\par            9 4 9 9 0 1 1 6 1 0 9 9 4 9\par            1 2 7 6 0 4 3 8 9 0 1 2 7 6\par            0 0 0 0 0 0 0 0 0 0 0 0 0 0\par            9 8 3 4 0 6 7 2 1 0 9 8 3 4\par            1 6 1 1 0 9 9 4 9 0 1 6 1 1\par            6 6 1 6 0 4 9 4 4 0 6 6 1 6\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\fs26            9 3 8 4 0 6 2 7 1 0 9 3 8 4\par }\pard \s15\qj\sb120\sa120\nowidctlpar\widctlpar\adjustright {\b\f0\fs26 Sum matrices with ordinary addition instead of modulo addition\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 If there exist sum matrices for given n with ordinary addition, then these are sum matrices for all bases b with modulo addition. \par For n=4 and n=5, there exists only one basic matrix each:\par }\pard \s15\nowidctlpar\widctlpar\adjustright {\fs26      1  0  0  1            1  1  0 -1 -1   \par      1 -1 -1  1            0  0  0  0  0   \par      1 -1 -1  1           -1 -1  0  1  1\par      1  0  0  1            0  0  0  0  0\par }\pard \s15\sa120\nowidctlpar\widctlpar\adjustright {\fs26                            1  1  0 -1 -1\par }\pard \s15\qj\sa120\nowidctlpar\widctlpar\adjustright {\f0\fs26 All other matrices for n}{\f0\fs26\lang1033 =4 and n=5 can be constructed as sums of multiples, rotations and reflections of the basic matrices.\par For all other values of n from 2 to 100, the only basic matrices are the extensions of the two given ones above (as described in the previous section). I don\rquote t know if there are others for higher n.\par }{\b\f0\fs26\lang1033 Interesting remark about primitivity:}{\f0\fs26\lang1033  The basic matrix for n=5 is not primitive, but the sum of it and its 90 degree rotation is primitive. So the terms \rdblquote basic\'94 in this sense and \rdblquote primitive\'94 are independent. (This holds for modulo addition either.) This seems to make it difficult to classify the primitive sum matrices. The extensions and combinations of the two matrices above yield only non-primitive matrices for the various n with a single exception for n=29 (add extensions of both matrices and their rotations).\par }{\f0\fs26 \par }}