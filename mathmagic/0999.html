<!doctype html public "-//IETF//DTD HTML//EN"><HTML><HEAD><TITLE>Math Magic</TITLE></HEAD><BODY background="formulas.gif"><font size=+1><CENTER><H1> Problem of the Month (September 1999)</H1></CENTER>In linear algebra, a square matrix has an equal number of rows and columns.  This month, we use a different definition.  A matrix is called <b>square</b> if each each entry is a digit, and reading across each row and down each column gives a square number.  For example,<p><center><table><tr><td>8<td>4<td>1</tr><tr><td>1<td>9<td>6</tr></table></center><p>is a square matrix since 841, 196, 81, 49, and 16 are all square integers.  Leading zeroes are not allowed.  Not all the squares produced have to be different.<p>How many square m x n matrices are there?  Are there square matrices of all sizes?  Are there infinitely many?  What is the largest square matrix you can find?<P><hr><p><center><h1>ANSWERS</h1></center>Ulrich Schimke found all of the matrices below, though his program had a bug in it the first time around.  He found 1584 square matrices in all.  He proved that the second-to-last digit in a 1 &times; n square matrix is a 4.  He also gives a heuristic probability argument why there are only finitely many 1 &times; n square matrices.<p>Andrew Bayly found most of the matrices below.    He also noted that the search is simplified somewhat by the fact that squares only end in 0, 1, 4, 5, 6, or 9.  He also found several square matrices with leading zeroes.<p>Joseph DeVincentis found the 1 &times; n and 2 &times; n square matrices up to n=5, and all the 3 &times; 3 ones.  He also gave an efficient algorithm to find 2 &times; n matrices, using the fact that the top row completely determines the bottom row.<p>Brendan Owen claims that there are no square 2 &times; 10 matrices.  All the others gave some sizes with no square matrices (like 4 &times; 2).<p>Bayly and Schimke noted that any of the 1 &times; n square matrices of odd length can be turned into an n x n square matrix by adding lots of zeroes in the bottom right hand corner.  The largest known square matrix (21 &times; 21) is of this form, with first row and column 444411911999914911441 and all the rest zeroes.<p>

<P><hr><p>The 1 &times; n square matrices are squares where every digit is a non-zero square.  This sequence: 1, 4, 9, 49, 144, 441, 1444, 11449, 44944, 991494144, 4914991449, 149991994944, 9141411449911441, 199499144494999441, 9914419419914449449, 444411911999914911441,419994999149149944149149944191494441 (the last one known) is sequence  <A HREF="http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=006716" >A006716</A> of the Encyclopedia of Integer Sequences.<p>The 2 &times; n matrices found so far are:<p><center><table cellpadding=8><tr><td><table><tr><td>1<td>6</tr><tr><td>6<td>4</tr></table></td><td><table><tr><td>3<td>6</tr><tr><td>6<td>4</tr></table></td><td><table><tr><td>6<td>4</tr><tr><td>4<td>9</tr></table></td><td><table><tr><td>8<td>1</tr><tr><td>1<td>6</tr></table></td><td><table><tr><td>8<td>4<td>1</tr><tr><td>1<td>9<td>6</tr></table></td><td><table><tr><td>1<td>1<td>2<td>3<td>6</tr>      <tr><td>6<td>6<td>5<td>6<td>4</tr></table></td></tr></table></center><p>The 3 &times; n matrices found so far are:<p><center><table cellpadding=8><tr><td><table><tr><td>1<td>2<td>1</tr><tr><td>2<td>5<td>6</tr>      <tr><td>1<td>6<td>9</tr></table></td><td><table><tr><td>1<td>2<td>1</tr><tr><td>2<td>8<td>9</tr>      <tr><td>1<td>9<td>6</tr></table></td><td><table><tr><td>1<td>4<td>4</tr><tr><td>4<td>0<td>0</tr>      <tr><td>4<td>0<td>0</tr></table></td><td><table><tr><td>1<td>4<td>4</tr><tr><td>4<td>8<td>4</tr>      <tr><td>4<td>4<td>1</tr></table></td><td><table><tr><td>1<td>6<td>9</tr><tr><td>6<td>7<td>6</tr>      <tr><td>9<td>6<td>1</tr></table></td><td><table><tr><td>3<td>6<td>1</tr><tr><td>6<td>7<td>6</tr>      <tr><td>1<td>6<td>9</tr></table></td><td><table><tr><td>4<td>4<td>1</tr><tr><td>4<td>0<td>0</tr>      <tr><td>1<td>0<td>0</tr></table></td><td><table><tr><td>4<td>4<td>1</tr><tr><td>4<td>8<td>4</tr>      <tr><td>1<td>4<td>4</tr></table></td><td><table><tr><td>5<td>2<td>9</tr><tr><td>2<td>5<td>6</tr>      <tr><td>9<td>6<td>1</tr></table></td></tr></table></center><p><center><table cellpadding=8><tr><td><table><tr><td>7<td>2<td>9</tr><tr><td>2<td>5<td>6</tr>      <tr><td>9<td>6<td>1</tr></table></td><td><table><tr><td>8<td>4<td>1</tr><tr><td>4<td>0<td>0</tr>      <tr><td>1<td>0<td>0</tr></table></td><td><table><tr><td>8<td>4<td>1</tr><tr><td>4<td>8<td>4</tr>      <tr><td>1<td>4<td>4</tr></table></td><td><table><tr><td>9<td>6<td>1</tr><tr><td>6<td>7<td>6</tr>      <tr><td>1<td>6<td>9</tr></table></td><td><table><tr><td>5<td>4<td>4<td>6<td>4<td>4</tr>      <tr><td>2<td>0<td>0<td>7<td>0<td>4</tr>      <tr><td>9<td>0<td>0<td>6<td>0<td>1</tr></table></td><td><table><tr><td>1<td>1<td>2<td>7<td>8<td>4<td>4</tr>      <tr><td>2<td>9<td>5<td>8<td>4<td>0<td>0</tr>      <tr><td>1<td>6<td>6<td>4<td>1<td>0<td>0</tr></table></td><td><table><tr><td>5<td>2<td>3<td>4<td>9<td>4<td>4</tr>      <tr><td>2<td>5<td>6<td>0<td>0<td>0<td>0</tr>      <tr><td>9<td>6<td>1<td>0<td>0<td>0<td>0</tr></table></td></tr></table></center><p>The 4 &times; n matrices found so far are:<p><center><table cellpadding=8><tr><td><table><tr><td>1<td>2<td>9<td>6</tr><tr><td>2<td>0<td>2<td>5</tr>      <tr><td>9<td>2<td>1<td>6</tr><tr><td>6<td>5<td>6<td>1</tr></table></td><td><table><tr><td>1<td>3<td>6<td>9</tr><tr><td>3<td>8<td>4<td>4</tr>      <tr><td>6<td>4<td>0<td>0</tr><tr><td>9<td>4<td>0<td>9</tr></table></td><td><table><tr><td>2<td>1<td>1<td>6</tr><tr><td>1<td>2<td>2<td>5</tr>      <tr><td>1<td>2<td>9<td>6</tr><tr><td>6<td>5<td>6<td>1</tr></table></td><td><table><tr><td>2<td>1<td>1<td>6</tr><tr><td>1<td>7<td>6<td>4</tr>      <tr><td>1<td>6<td>0<td>0</tr><tr><td>6<td>4<td>0<td>0</tr></table></td><td><table><tr><td>2<td>9<td>1<td>6</tr><tr><td>9<td>0<td>2<td>5</tr>      <tr><td>1<td>2<td>9<td>6</tr><tr><td>6<td>5<td>6<td>1</tr></table></td><td><table><tr><td>3<td>1<td>3<td>6</tr><tr><td>1<td>7<td>6<td>4</tr>      <tr><td>3<td>6<td>0<td>0</tr><tr><td>6<td>4<td>0<td>0</tr></table></td><td><table><tr><td>3<td>3<td>6<td>4</tr><tr><td>3<td>2<td>4<td>9</tr>      <tr><td>6<td>4<td>0<td>0</tr><tr><td>4<td>9<td>0<td>0</tr></table></td><td><table><tr><td>3<td>7<td>2<td>1</tr><tr><td>7<td>0<td>5<td>6</tr>      <tr><td>2<td>5<td>0<td>0</tr><tr><td>1<td>6<td>0<td>0</tr></table></td></tr></table></center><p><center><table cellpadding=8><tr><td><table><tr><td>7<td>3<td>9<td>6</tr><tr><td>3<td>0<td>2<td>5</tr>      <tr><td>9<td>2<td>1<td>6</tr><tr><td>6<td>5<td>6<td>1</tr></table></td><td><table><tr><td>7<td>9<td>2<td>1</tr><tr><td>9<td>8<td>0<td>1</tr>      <tr><td>2<td>0<td>2<td>5</tr><tr><td>1<td>1<td>5<td>6</tr></table></td><td><table><tr><td>8<td>2<td>8<td>1</tr><tr><td>2<td>1<td>1<td>6</tr>      <tr><td>8<td>1<td>0<td>0</tr><tr><td>1<td>6<td>0<td>0</tr></table></td><td><table><tr><td>8<td>2<td>8<td>1</tr><tr><td>2<td>9<td>1<td>6</tr>      <tr><td>8<td>1<td>0<td>0</tr><tr><td>1<td>6<td>0<td>0</tr></table></td><td><table><tr><td>8<td>8<td>3<td>6</tr><tr><td>8<td>4<td>6<td>4</tr>      <tr><td>3<td>6<td>0<td>0</tr><tr><td>6<td>4<td>0<td>0</tr></table></td><td><table><tr><td>9<td>2<td>1<td>6</tr><tr><td>2<td>0<td>2<td>5</tr>      <tr><td>1<td>2<td>9<td>6</tr><tr><td>6<td>5<td>6<td>1</tr></table></td><td><table><tr><td>1<td>7<td>1<td>6<td>1</tr>      <tr><td>2<td>3<td>1<td>0<td>4</tr>      <tr><td>2<td>9<td>5<td>8<td>4</tr>      <tr><td>5<td>6<td>6<td>4<td>4</tr></table></td><td><table><tr><td>5<td>3<td>3<td>1<td>4<td>8<td>1</tr>      <tr><td>4<td>6<td>0<td>5<td>3<td>1<td>6</tr>      <tr><td>7<td>0<td>2<td>2<td>5<td>0<td>0</tr>      <tr><td>6<td>0<td>5<td>1<td>6<td>0<td>0</tr></table></td></tr></table></center><p>There are too many 5 &times; 5's and 6 &times; 6's to list, but here are the 5 &times; 6 square matrices:<p><center><table cellpadding=8><tr><td><table><tr><td>1<td>9<td>1<td>8<td>4<td>4</tr>      <tr><td>1<td>4<td>4<td>4<td>0<td>0</tr>      <tr><td>6<td>2<td>4<td>1<td>0<td>0</tr>      <tr><td>6<td>4<td>0<td>0<td>0<td>0</tr>      <tr><td>4<td>9<td>0<td>0<td>0<td>0</tr></table></td><td><table><tr><td>2<td>8<td>9<td>4<td>4<td>4</tr>      <tr><td>9<td>6<td>0<td>4<td>0<td>0</tr>      <tr><td>9<td>4<td>0<td>9<td>0<td>0</tr>      <tr><td>2<td>3<td>0<td>4<td>0<td>0</tr>      <tr><td>9<td>6<td>0<td>4<td>0<td>0</tr></table></td><td><table><tr><td>3<td>8<td>5<td>6<td>4<td>1</tr>      <tr><td>6<td>2<td>8<td>8<td>4<td>9</tr>      <tr><td>4<td>9<td>5<td>6<td>1<td>6</tr>      <tr><td>8<td>4<td>6<td>4<td>0<td>0</tr>      <tr><td>1<td>4<td>4<td>4<td>0<td>0</tr></table></td></tr></table></center><p>All of the n &times; n square matrices found so far are symmetric about the main diagonal.  Are there any that are not symmetric?  There answer is yes if we allow leading zeroes, such as this one found by Andrew Bayly:<p><center><table><tr><td><table><tr><td>8<td>1<td>0<td>0</tr><tr><td>2<td>4<td>0<td>1</tr>      <tr><td>8<td>4<td>6<td>4</tr><tr><td>1<td>4<td>4<td>4</tr></table></td></tr></table></center><p>He and Ulrich Schimke also found this 5 &times; 5 square matrix with the amazing properties that the diagonals are also squares, and all the squares are palindromes:<p><center><table><tr><td><table><tr><td>1<td>4<td>6<td>4<td>1</tr><tr><td>4<td>4<td>9<td>4<td>4</tr>      <tr><td>6<td>9<td>6<td>9<td>6</tr><tr><td>4<td>4<td>9<td>4<td>4</tr>      <tr><td>1<td>4<td>6<td>4<td>1</tr></table></td></tr></table></center><p>

<P><HR>Schimke defined two square matrices to be <b>twins</b> if they differ in only one entry.  He found the 4 pairs of twins below, plus 6 larger pairs.  Are there any more?<p><center><table cellpadding=8><tr><td><table><tr><td>5<td>2<td>9</tr><tr><td>2<td>5<td>6</tr>      <tr><td>9<td>6<td>1</tr></table></td><td><table><tr><td>7<td>2<td>9</tr><tr><td>2<td>5<td>6</tr>      <tr><td>9<td>6<td>1</tr></table></td><td><table><tr><td>8<td>2<td>8<td>1</tr><tr><td>2<td>1<td>1<td>6</tr>      <tr><td>8<td>1<td>0<td>0</tr><tr><td>1<td>6<td>0<td>0</tr></table></td><td><table><tr><td>8<td>2<td>8<td>1</tr><tr><td>2<td>9<td>1<td>6</tr>      <tr><td>8<td>1<td>0<td>0</tr><tr><td>1<td>6<td>0<td>0</tr></table></td><td><table><tr><td>1<td>9<td>5<td>3<td>6<td>4</tr>      <tr><td>9<td>8<td>6<td>0<td>4<td>9</tr>      <tr><td>5<td>6<td>1<td>0<td>0<td>1</tr>      <tr><td>3<td>0<td>0<td>3<td>0<td>4</tr>      <tr><td>6<td>4<td>0<td>0<td>0<td>0</tr>      <tr><td>4<td>9<td>1<td>4<td>0<td>1</tr></table></td><td><table><tr><td>1<td>9<td>5<td>3<td>6<td>4</tr>      <tr><td>9<td>8<td>6<td>0<td>4<td>9</tr>      <tr><td>5<td>6<td>4<td>0<td>0<td>1</tr>      <tr><td>3<td>0<td>0<td>3<td>0<td>4</tr>      <tr><td>6<td>4<td>0<td>0<td>0<td>0</tr>      <tr><td>4<td>9<td>1<td>4<td>0<td>1</tr></table></td><td><table><tr><td>1<td>6<td>7<td>2<td>8<td>1</tr>      <tr><td>6<td>0<td>0<td>6<td>2<td>5</tr>      <tr><td>7<td>0<td>2<td>2<td>4<td>4</tr>      <tr><td>2<td>6<td>2<td>1<td>4<td>4</tr>      <tr><td>8<td>2<td>4<td>4<td>6<td>4</tr>      <tr><td>1<td>5<td>4<td>4<td>4<td>9</tr></table></td><td><table><tr><td>1<td>6<td>7<td>2<td>8<td>1</tr>      <tr><td>6<td>8<td>0<td>6<td>2<td>5</tr>      <tr><td>7<td>0<td>2<td>2<td>4<td>4</tr>      <tr><td>2<td>6<td>2<td>1<td>4<td>4</tr>      <tr><td>8<td>2<td>4<td>4<td>6<td>4</tr>      <tr><td>1<td>5<td>4<td>4<td>4<td>9</tr></table></td></tr></table></center><p>Here are the number of different square matrices of different sizes:<p><p><CENTER><H2>Number of m &times; n Square Matrices</H2></CENTER><center><TABLE BORDER bgcolor="FFFFCF" cellpadding=5><tr bgcolor=lightgreen><th>m \ n<th>1<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10  <th>11<th>12</tr><tr><th bgcolor=lightgreen>1<td>3<td>1<td>2<td>1<td>2<td>0<td>0<td>0<td>1  <td>1<td>0<td>1</tr><tr><th bgcolor=lightgreen>2<td>1<td>4<td>1<td>0<td>1<td>0<td>0<td>0<td>0</tr><tr><th bgcolor=lightgreen>3<td>2<td>1<td>13<td>0<td>3<td>1<td>2<td>0<td>0</tr><tr><th bgcolor=lightgreen>4<td>1<td>0<td>0<td>14<td>1<td>0<td>1</tr><tr><th bgcolor=lightgreen>5<td>2<td>1<td>3<td>1<td>76<td>3</tr><tr><th bgcolor=lightgreen>6<td>0<td>0<td>1<td>0<td>3<td>108</tr></TABLE></center><P>In addition, Ulrich Schimke found that there are 459 symmetric 7 &times; 7 square matrices, and 844 symmetric 8 &times; 8 square matrices.  No one knows if there are non-symmetric matrices of these sizes.<p><HR><p>If you can extend any of these results, please <a href="mailto:erichfriedman68@gmail.com">e-mail</a> me.  Click <a href="https://erich-friedman.github.io/mathmagic/">here</a> to go back to Math Magic.  <font size=-1>Last updated 10/5/99.<font></BODY></HTML>