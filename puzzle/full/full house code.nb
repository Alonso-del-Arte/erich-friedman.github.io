(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     18976,        531]
NotebookOptionsPosition[     18446,        510]
NotebookOutlinePosition[     18828,        526]
CellTagsIndexPosition[     18785,        523]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"box", "[", 
   RowBox[{"n_", ",", "m_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"A", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[Equal]", "1"}], "||", 
           RowBox[{"i", "\[Equal]", 
            RowBox[{"n", "+", "2"}]}], "||", 
           RowBox[{"j", "\[Equal]", "1"}], "||", 
           RowBox[{"j", "\[Equal]", 
            RowBox[{"m", "+", "2"}]}]}], ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "+", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"m", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", 
        RowBox[{"m", " ", "n"}], "]"}], ",", 
       RowBox[{"coun", "=", "1"}], ",", 
       RowBox[{"coun", "=", "0"}]}], "]"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "k"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "\[LeftDoubleBracket]", 
            RowBox[{"Sequence", "@@", "g"}], "\[RightDoubleBracket]"}], 
           "\[Equal]", "1"}], ",", 
          RowBox[{"g", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"n", "+", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"m", "+", "1"}]}], "}"}], "]"}]}], "}"}]}]}], "]"}], 
        ";", 
        RowBox[{"A", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"A", ",", "1", ",", "g"}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", 
           RowBox[{
            RowBox[{
            "g", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "g", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}], ",", 
          RowBox[{"coun", "++"}], ",", 
          RowBox[{"coun", "--"}]}], "]"}]}]}], "]"}], ";", 
     RowBox[{"chec", "[", "A", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "B", "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"FF", "=", 
         RowBox[{"Last", "[", 
          RowBox[{"B", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"SS", "=", 
         RowBox[{"First", "[", 
          RowBox[{"B", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"B", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
            RowBox[{"B", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "/", "3"}]}], 
        ";", 
        RowBox[{
         RowBox[{"B", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"B", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}], "+", 
            RowBox[{"B", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}], "/", "3"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"pic1", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ",", "i"}], "}"}]}], "}"}], 
                 "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"m", "+", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"m", "+", "1"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Rectangle", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"#1", "-", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], "&"}], ")"}], "/@", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"A", ",", "1"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "<", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{"n", "+", "2"}]}], "&&", 
                   RowBox[{"1", "<", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "<", 
                    RowBox[{"m", "+", "2"}]}]}], "&"}]}], "]"}]}]}], "}"}], 
            ",", 
            RowBox[{"Antialiasing", "\[Rule]", "False"}]}], "]"}], "]"}]}], 
        ";", 
        RowBox[{"pic2", "=", 
         RowBox[{"Graphics", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
              RowBox[{"RGBColor", "[", 
               RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
              RowBox[{"Line", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#1", "-", 
                   RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", 
                    FractionBox["1", "2"]}], "}"}]}], "&"}], ")"}], "/@", 
                RowBox[{
                "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "]"}], ",", "Purple", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<S\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
                RowBox[{"SS", "-", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox["1", "2"], ",", 
                   FractionBox["1", "2"]}], "}"}]}]}], "]"}], ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<F\>\"", ",", 
                  RowBox[{"FontSize", "\[Rule]", "Large"}]}], "]"}], ",", 
                RowBox[{"FF", "-", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox["1", "2"], ",", 
                   FractionBox["1", "2"]}], "}"}]}]}], "]"}]}], "}"}], ",", 
            RowBox[{"Antialiasing", "\[Rule]", "False"}]}], "]"}], "]"}]}], 
        ";", 
        RowBox[{"p1", "=", 
         RowBox[{"Show", "[", 
          RowBox[{"pic1", ",", 
           RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", ".01"}], ",", 
                RowBox[{"n", "+", "1.01"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", ".01"}], ",", 
                RowBox[{"m", "+", "1.01"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"35", " ", "n"}], ",", 
              RowBox[{"35", " ", "m"}]}], "}"}]}]}], "]"}]}], ";", 
        RowBox[{"p2", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pic1", ",", "pic2"}], "}"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", ".01"}], ",", 
                RowBox[{"n", "+", "1.01"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "-", ".01"}], ",", 
                RowBox[{"m", "+", "1.01"}]}], "}"}]}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"35", " ", "n"}], ",", 
              RowBox[{"35", " ", "m"}]}], "}"}]}]}], "]"}]}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"Show", "[", 
          RowBox[{"GraphicsRow", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2"}], "}"}], ",", 
            RowBox[{"DisplayFunction", "\[Rule]", "$DisplayFunction"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"65", " ", "n"}], ",", 
               RowBox[{"30", " ", "m"}]}], "}"}]}]}], "]"}], "]"}], "]"}]}]}],
       "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.456509859226392*^9, 3.456509907590622*^9}, {
  3.456509942836828*^9, 3.456509965470766*^9}, {3.45651006301166*^9, 
  3.456510107482244*^9}, {3.4565101926297693`*^9, 3.456510229263968*^9}, {
  3.52508067714235*^9, 3.525080736541587*^9}, {3.5250807812863207`*^9, 
  3.52508080670577*^9}, {3.52508084958148*^9, 3.525080867968231*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"width", ",", "depth", ",", 
   RowBox[{"black", " ", "squares"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.456509807254651*^9, 3.456509818897753*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chec", "[", "A_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"B", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
     RowBox[{"stack", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], ",", 
        RowBox[{"Position", "[", 
         RowBox[{"A", ",", "0"}], "]"}]}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coun", "==", "1"}], ",", 
       RowBox[{"stack", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"A", ",", "0"}], "]"}], ",", 
            RowBox[{
             RowBox[{"EvenQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
         "]"}]}]}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"coun", "==", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"stack", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"A", ",", "0"}], "]"}], ",", 
            RowBox[{
             RowBox[{"OddQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
         "]"}]}]}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "coun", "]"}], "<=", "1"}], ",", "\n", "    ", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "stack", "]"}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "B", "]"}], "<", "2"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"path", "=", 
           RowBox[{"Last", "[", "stack", "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"stack", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"stack", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"last", "=", 
           RowBox[{"Last", "[", "path", "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"nbrs", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"last", "+", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0"}], "}"}]}], ",", 
               RowBox[{"last", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1"}], "}"}]}], ",", 
               RowBox[{"last", "+", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ",", 
               RowBox[{"last", "+", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}]}], "}"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"path", ",", "#"}], "]"}]}], "&&", 
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"[", 
                  RowBox[{"Apply", "[", 
                   RowBox[{"Sequence", ",", "#"}], "]"}], "]"}], "]"}], "==", 
                "0"}]}], "&"}]}], "]"}]}], ";", "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "nbrs", "]"}], "==", "0"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "path", "]"}], "==", 
               RowBox[{"Length", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"A", ",", "0"}], "]"}], "]"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"B", ",", "path"}], "]"}]}], "]"}]}], "]"}], ";", "\n",
           "\t\t\t", 
          RowBox[{"stack", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"stack", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"path", ",", 
                  RowBox[{"f", "[", 
                   RowBox[{"last", ",", "#"}], "]"}]}], "]"}], "&"}], ",", 
               "nbrs"}], "]"}]}], "]"}]}]}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"z", "=", "1"}], ";", "\n", "\t\t", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"Apply", "[", 
            RowBox[{"Sequence", ",", 
             RowBox[{"b", "+", 
              RowBox[{"z", 
               RowBox[{"(", 
                RowBox[{"b", "-", "a"}], ")"}]}]}]}], "]"}], "]"}], "]"}], "==",
          "0"}], "&&", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"path", ",", 
           RowBox[{"b", "+", 
            RowBox[{"z", 
             RowBox[{"(", 
              RowBox[{"b", "-", "a"}], ")"}]}]}]}], "]"}]}]}], ",", 
       RowBox[{"z", "++"}]}], "]"}], ";", "\n", "\t\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"b", "+", 
        RowBox[{"y", 
         RowBox[{"(", 
          RowBox[{"b", "-", "a"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", 
         RowBox[{"z", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"yi", "=", "1"}], ",", 
   RowBox[{"yi", ">", "0"}], ",", 
   RowBox[{"yi", "++"}], ",", 
   RowBox[{"box", "[", 
    RowBox[{"9", ",", "9", ",", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"7", ",", "11"}], "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.456509837827716*^9, 3.45650984023361*^9}, 
   3.456509871124592*^9, {3.456509927654628*^9, 3.456509928012393*^9}, {
   3.525083523867463*^9, 3.5250835249298964`*^9}, {3.525085073931506*^9, 
   3.5250850782574377`*^9}, {3.525089086298173*^9, 3.525089106859571*^9}, {
   3.5250962255393543`*^9, 3.5250962380820208`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.52641386555611*^9}]
}, Open  ]]
},
WindowToolbars->{"RulerBar", "EditBar"},
WindowSize->{857, 794},
WindowMargins->{{Automatic, 335}, {Automatic, 21}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 10818, 284, 423, "Input"],
Cell[11366, 306, 192, 4, 27, "Input"],
Cell[11561, 312, 4863, 133, 223, "Input"],
Cell[16427, 447, 1223, 38, 73, "Input"],
Cell[CellGroupData[{
Cell[17675, 489, 676, 15, 27, "Input"],
Cell[18354, 506, 76, 1, 27, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
